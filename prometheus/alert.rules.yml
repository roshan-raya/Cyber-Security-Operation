groups:
  - name: example
    interval: 1m
    rules: []

  - name: patch_alerts
    interval: 1m
    rules:
      - alert: PatchFailure
        expr: patch_host_success == 0
        for: 1m
        labels:
          severity: warning
        annotations:
          summary: "Patch run failed for host {{ $labels.host }}"

      - alert: PatchDurationTooHigh
        expr: patch_run_duration_seconds > 120
        for: 1m
        labels:
          severity: warning
        annotations:
          summary: "Patch run duration exceeded 120 seconds"

      - alert: PatchNotRunRecently
        expr: (time() - patch_last_run_timestamp) > 86400
        for: 5m
        labels:
          severity: warning
        annotations:
          summary: "No patch run in the last 24 hours"
