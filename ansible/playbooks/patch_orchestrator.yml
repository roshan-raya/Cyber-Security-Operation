---
# ===============================
# Play 1: Patch All Targets
# ===============================
- name: Patch all hosts
  hosts: all
  strategy: free
  gather_facts: true

  vars:
    patch_group: "{{ patch_group | default('all') }}"

  roles:
    - common
    - health_check
    - patch


# ===============================
# Play 2: Reporting (Single Host)
# ===============================
- name: Generate patch reports
  hosts: localhost
  gather_facts: false

  roles:
    - reporting
